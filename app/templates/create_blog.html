{% extends "home.html" %}
{% block centermain %}

<h2>Create Blog</h2>

<form action="{{ url_for('home.create_blog') }}"
      method="POST"
      enctype="multipart/form-data">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

    <input type="text" name="title" placeholder="Blog title" required>
    <br><br>

    <label>Blog Description (max 150 words)</label><br>
    <textarea id="description" name="description" rows="6" cols="60" required></textarea>
    <br>

    <small>
        Words: <span id="wordCount">0</span> / 150 |
        Remaining: <span id="wordsLeft">150</span>
    </small>
    <br><br>

    <input type="file" name="image" accept="image/*">
    <br><br>

    <button type="submit" id="submitBtn">Create Blog</button>
</form>

<script>
const textarea = document.getElementById("description");
const wordCountSpan = document.getElementById("wordCount");
const wordsLeftSpan = document.getElementById("wordsLeft");
const submitBtn = document.getElementById("submitBtn");

const MAX_WORDS = 150;

function getWordCount(text) {
    return text.trim() === "" ? 0 : text.trim().split(/\s+/).length;
}

textarea.addEventListener("input", () => {
    const count = getWordCount(textarea.value);
    wordCountSpan.textContent = count;
    wordsLeftSpan.textContent = MAX_WORDS - count;

    submitBtn.disabled = count > MAX_WORDS;
});
</script>

{% endblock %}

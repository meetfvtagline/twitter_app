{% extends "home.html" %}

{% block centermain %}
{% if user %}

<style>
/* ===== Layout ===== */
.profile-wrapper {
    max-width: 720px;
    margin: 0 auto;
    display: flex;
    flex-direction: column;
    gap: 28px;
}

/* ===== Profile Card ===== */
.profile-card {
    background-color: #16181c;
    border: 1px solid #2f3336;
    border-radius: 16px;
    padding: 24px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.profile-info {
    display: flex;
    flex-direction: column;
    gap: 6px;
}

.profile-username {
    font-size: 24px;
    font-weight: 700;
}

.profile-email {
    font-size: 14px;
    color: #71767b;
}

.profile-action {
    padding: 10px 18px;
    border-radius: 999px;
    background-color: #1d9bf0;
    color: #fff;
    font-weight: 600;
    font-size: 14px;
}

.profile-action:hover {
    background-color: #1a8cd8;
    text-decoration: none;
}

/* ===== Blogs ===== */
.blogs-title {
    font-size: 20px;
    font-weight: 700;
    margin-bottom: 8px;
}

.blog-list {
    display: flex;
    flex-direction: column;
    gap: 18px;
}

/* ===== Blog Card ===== */
.blog-card {
    background-color: #16181c;
    border: 1px solid #2f3336;
    border-radius: 16px;
    padding: 18px;
    display: flex;
    flex-direction: column;
    gap: 12px;
    transition: background 0.2s ease, transform 0.2s ease;
}

.blog-card:hover {
    background-color: #1b1f24;
    transform: translateY(-2px);
}

.blog-title {
    font-size: 18px;
    font-weight: 600;
}

.blog-description {
    font-size: 14px;
    color: #e7e9ea;
    line-height: 1.6;
}

.blog-image {
    width: 100%;
    border-radius: 12px;
    margin-top: 6px;
}

/* ===== Footer ===== */
.blog-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 6px;
    font-size: 13px;
    color: #71767b;
}

.likes-badge {
    background-color: #1f2937;
    padding: 6px 12px;
    border-radius: 999px;
    font-weight: 500;
}

/* ===== Owner Actions ===== */
.owner-actions {
    display: flex;
    gap: 12px;
    margin-top: 10px;
}

.edit-link {
    padding: 6px 14px;
    border-radius: 999px;
    background-color: #1d9bf0;
    color: white;
    font-size: 13px;
    font-weight: 500;
}

.edit-link:hover {
    background-color: #1a8cd8;
    text-decoration: none;
}

.delete-btn {
    padding: 6px 14px;
    border-radius: 999px;
    background-color: #ef4444;
    border: none;
    color: white;
    font-size: 13px;
    font-weight: 500;
    cursor: pointer;
}

.delete-btn:hover {
    background-color: #dc2626;
}

/* ===== Empty State ===== */
.empty-text {
    color: #71767b;
    font-size: 14px;
    text-align: center;
    padding: 32px;
}
</style>

<div class="profile-wrapper">

    <!-- Profile -->
    <section class="profile-card">
        <div class="profile-info">
            <h2 class="profile-username">{{ user.username }}</h2>
            <p class="profile-email">{{ user.email }}</p>
        </div>

        <a href="{{ url_for('auth.change_pass') }}" class="profile-action">
            Change Password
        </a>
    </section>

    <!-- Blogs -->
    <section>
        <h3 class="blogs-title">Your Blogs</h3>

        <div class="blog-list">
            {% set has_blog = false %}
            {% for blog in blogs %}
                {% if blog.user_id == user.id %}
                    {% set has_blog = true %}
                    <article class="blog-card">

                        <h4 class="blog-title">{{ blog.title }}</h4>
                        <p class="blog-description">{{ blog.description }}</p>

                        {% if blog.image_path %}
                            <img
                                src="{{ url_for('static', filename=blog.image_path) }}"
                                alt="Blog image"
                                class="blog-image"
                            >
                        {% endif %}

                        <div class="blog-footer">
                            <span>{{ blog.likes|length }} Likes</span>
                            <span class="likes-badge">❤️</span>
                        </div>

                        <div class="owner-actions">
                            <a href="{{ url_for('home.update_blog', blog_id=blog.id) }}" class="edit-link">
                                Edit
                            </a>

                            <form method="POST"
                                  action="{{ url_for('home.delete_blog') }}"
                                  onsubmit="return confirm('Are you sure you want to delete this blog?');">
                                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                                <button name="delete" value="{{ blog.id }}" class="delete-btn">
                                    Delete
                                </button>
                            </form>
                        </div>

                    </article>
                {% endif %}
            {% endfor %}

            {% if not has_blog %}
                <p class="empty-text">You haven’t posted any blogs yet.</p>
            {% endif %}
        </div>
    </section>

</div>

{% endif %}
{% endblock %}
